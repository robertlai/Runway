// Generated by CoffeeScript 1.9.3
angular.module('runwayApp').controller('homeController', function($scope, $http) {
  var socket;
  socket = io();
  $scope.newGroupName = '';
  $scope.error = null;
  socket.on('groupList', function(groups) {
    $scope.groups = groups;
    return $scope.$apply();
  });
  socket.on('newGroup', function(newGroup) {
    $scope.groups.push(newGroup);
    $scope.error = null;
    return $scope.$apply();
  });
  $scope.addGroup = function() {
    if ($scope.newGroupName.trim().length > 0) {
      return $http.post('/api/newGroup?newGroupName=' + $scope.newGroupName).then(function(addedGroupName) {
        $scope.groups.push(addedGroupName.data);
        $scope.newGroupName = '';
        return $scope.newGroupError = null;
      }, function(err) {
        if (err.status === 409) {
          return $scope.newGroupError = 'This group already exists.';
        } else {
          return $scope.newGroupError = 'Server Error.  Please contact support.';
        }
      });
    }
  };
  return $http.get('/api/groups').then(function(groups) {
    $scope.groups = groups.data;
    return $scope.error = null;
  }, function(err) {
    return $scope.error = 'Server Error.  Please contact support.';
  });
});

// Generated by CoffeeScript 1.10.0
var app;

app = angular.module('workspaceApp', []);

app.controller('workspaceController', function($scope) {});

app.controller('messagesController', function($scope, $http, $interval) {
  var fetchNewMessages, lastMessageId, scrollToBottom;
  $scope.chatVisible = true;
  $scope.newCommentNotValide = false;
  lastMessageId = -1;
  $scope.messages = [];
  fetchNewMessages = function() {
    return $http.get('/api/messages').success(function(messages) {
      return $scope.messages = messages;
    }).error(function(error, status) {
      return console.log("no new messages");
    });
  };
  scrollToBottom = function() {
    var msgpanel;
    msgpanel = document.getElementById("msgpanel");
    return msgpanel.scrollTop = msgpanel.scrollHeight;
  };
  $interval(fetchNewMessages, 500);
  $scope.hideChat = function() {
    $scope.chatVisible = false;
    return document.getElementById('dropzone').style.width = '100%';
  };
  $scope.showChat = function() {
    $scope.chatVisible = true;
    return document.getElementById('dropzone').style.width = '75%';
  };
  return $scope.addComment = function() {
    if ($scope.newComment.trim().length > 0) {
      return $http.post('/api/message?user=Test User&content=' + $scope.newComment).then(function() {
        $scope.newComment = '';
        return $scope.newCommentNotValide = false;
      });
    }
  };
});

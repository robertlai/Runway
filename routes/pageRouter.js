// Generated by CoffeeScript 1.9.3
var isLoggedIn;

isLoggedIn = function(req, res, next) {
  if (req.isAuthenticated()) {
    return next();
  } else {
    return res.redirect('/login');
  }
};

module.exports = function(app, passport) {
  app.get('/login', function(req, res) {
    return res.render('login', {
      title: 'Login',
      message: req.flash('loginMessage')
    });
  });
  app.post('/login', passport.authenticate('local-login', {
    successRedirect: '/workspace',
    failureRedirect: '/login',
    failureFlash: true
  }));
  app.get('/register', function(req, res) {
    return res.render('register', {
      title: 'Register',
      message: req.flash('registerMessage')
    });
  });
  app.post('/register', passport.authenticate('local-register', {
    successRedirect: '/workspace',
    failureRedirect: '/register',
    failureFlash: true
  }));
  app.get('/workspace', isLoggedIn, function(req, res) {
    return res.render('workspace', {
      username: req.user.local.username
    });
  });
  app.get('/logout', function(req, res) {
    req.logout();
    return res.redirect('/login');
  });
  return app.get('*', function(req, res) {
    return res.redirect('/login');
  });
};
